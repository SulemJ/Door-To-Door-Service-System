<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin Dashboard - Add Service Provider</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <!-- <link href="styles/main.css" rel="stylesheet" />
    <link href="styles/admin.css" rel="stylesheet" /> -->
    <style>
      .work-experience-item {
        position: relative;
        margin-bottom: 10px;
      }

      .remove-experience {
        width: auto;
        padding: 0.375rem 0.75rem;
      }

      .work-experience-item input {
        border-top-right-radius: 0;
        border-bottom-right-radius: 0;
      }

      #workExperienceList {
        margin-bottom: 1rem;
      }
      .contain{
        margin-top: 20rem;
      }
    </style>
  </head>
<%- include('components/header.ejs') %>

  <body>
    
    <!-- <div id="header"></div> -->
    <div class="container contain mt-5">
      <h2>Admin Dashboard - Add Service Provider</h2>
      <form id="addProviderForm" class="mt-4" >
        <div class="row">
          <div class="col-md-6 mb-3">
            <label for="name" class="form-label">Full Name*</label>
            <input type="text" class="form-control" id="name" required />
          </div>
          

      <div class="col-md-6 mb-3">
  <label for="profession" class="form-label">Profession*</label>
<!-- Profession dropdown -->
<select id="profession" class="form-select" multiple required>
  <% if (categories && categories.length) { %>
    <% categories.forEach(cat => { %>
      <option value="<%= cat.id %>"><%= cat.name %></option>
    <% }) %>
  <% } %>
</select>
  <small class="text-muted">Hold Ctrl (Windows) or Cmd (Mac) to select multiple.</small>
</div>
<div class="col-md-6 mb-3">
  <label for="skills" class="form-label">Skills</label>
<!-- Skills dropdown -->
<select id="skills" class="form-select" multiple required>
  <% if (subcategories && subcategories.length) { %>
    <% subcategories.forEach(sub => { %>
      <option value="<%= sub.id %>"><%= sub.name %></option>
    <% }) %>
  <% } %>
</select>
 <small class="text-muted">Hold Ctrl (Windows) or Cmd (Mac) to select multiple.</small>
</div>



          <div class="col-md-6 mb-3">
            <label for="email" class="form-label">Email*</label>
            <input type="text" class="form-control" id="email" required />
          </div>
          <div class="col-md-6 mb-3">
            <label for="phone" class="form-label">Phone*</label>
            <input type="tel" class="form-control" id="phone" required />
          </div>
          <div class="col-12 mb-3">
            <label for="address" class="form-label">Address</label>
            <input type="text" class="form-control" id="address" />
          </div>
          
          </div>
          <div class="col-12 mb-3">
            <label for="personal-Info" class="form-label"
              >Personal Information</label>
            <textarea
              class="form-control"
              id="personal-Info"
              rows="4"
            ></textarea>
           </div>
          <div class="col-12 mb-3">
            <label class="form-label">Work Experience</label>
            <div id="workExperienceList"></div>
            <button type="button" class="btn btn-secondary" id="addExperience">
              Add Experience
            </button>
          </div>
          <div class="col-12">
            <button type="submit"  class="btn btn-primary">
              Add Service Provider
            </button>
          </div>
        </div>
      </form>
    </div>

<script>
  $(function() {
    $('#profession').select2({ placeholder: "Select profession(s)" });
    $('#skills').select2({ placeholder: "Select skill(s)" });
  });
</script>
<script>
    document.getElementById('addProviderForm').addEventListener('submit', async function (e) {
  e.preventDefault();

  const name = document.getElementById('name').value;
  const email = document.getElementById('email').value;
  const phone = document.getElementById('phone').value;
  const address = document.getElementById('address').value;
  const personalInfo = document.getElementById('personal-Info').value;

  const professionIds = [...document.getElementById('profession').selectedOptions].map(opt => opt.value);
  const skillIds = [...document.getElementById('skills').selectedOptions].map(opt => opt.value);

  const data = {
    name,
    email,
    phone,
    address,
    personalInfo,
    professions: professionIds,
    skills: skillIds
  };

  const res = await fetch("/api/admin/addProvider", {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(data)
  });

  const result = await res.json();
  alert(result.message);
});

</script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js"></script>
    
    <!-- <script src="jsFiles/admin.js"></script> -->
    <!-- <script src="jsFiles/adminNavbar.js"></script> -->
  </body>
</html>